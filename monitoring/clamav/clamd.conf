# Configuration de base pour ClamAV 1.0.9
# Chemin vers le socket local
LocalSocket /var/run/clamav/clamd.ctl
FixStaleSocket true
LocalSocketMode 666

# Activer l'écoute TCP
TCPSocket 3310
TCPAddr 0.0.0.0
MaxConnectionQueueLength 100
StreamMinPort 49152
StreamMaxPort 65535

# Configuration du scan
MaxThreads 8
MaxQueue 200
ReadTimeout 300
StreamMaxLength 100M
MaxFileSize 50M
MaxRecursion 10
MaxFiles 5000
MaxEmbeddedPE 5M
MaxHTMLNormalize 10M
MaxHTMLNoTags 2M
MaxScriptNormalize 5M
MaxZipTypeRcg 1M
ScanArchive true

# Optimisation des performances
Bytecode true
BytecodeSecurity TrustSigned
BytecodeTimeout 30000

# Configuration de la mémoire
MaxScanSize 50M
MaxFileSize 50M
MaxRecursion 10
MaxFiles 5000

# Désactiver les signatures inutiles
ScanPE true

# Journalisation
LogFile /var/log/clamav/clamav.log
LogClean false
LogTime true
LogVerbose true
Foreground true

# Détection des menaces
PhishingSignatures true
PhishingScanURLs true
PhishingAlwaysBlockSSLMismatch false
PhishingAlwaysBlockCloak false

# Optimisation pour les fichiers images
OLE2BlockMacros false
ScanPDF false
ScanSWF false

# Base de données
DatabaseDirectory /var/lib/clamav
# Les mises à jour sont gérées par freshclam dans le conteneur
