# Configuration de base pour ClamAV 1.0.9
# Chemin vers le socket local
LocalSocket /var/run/clamav/clamd.ctl
FixStaleSocket true
LocalSocketMode 666

# Activer l'écoute TCP
TCPSocket 3310
TCPAddr 0.0.0.0
MaxConnectionQueueLength 30
StreamMinPort 49152
StreamMaxPort 65535

# Configuration du scan
MaxThreads 4
StreamMaxLength 100M
MaxFileSize 50M
MaxRecursion 16
MaxFiles 10000
MaxEmbeddedPE 10M
MaxHTMLNormalize 10M
MaxHTMLNoTags 2M
MaxScriptNormalize 5M
MaxZipTypeRcg 1M
ScanArchive true

# Configuration des performances
Bytecode true
BytecodeSecurity TrustSigned
BytecodeTimeout 60000

# Configuration de la mémoire
MaxScanSize 100M
MaxFileSize 50M
MaxRecursion 16
MaxFiles 10000

# Désactiver les signatures inutiles
ScanPE true

# Journalisation
LogFile /var/log/clamav/clamav.log
LogClean false
LogTime true
LogVerbose true
Foreground true

# Détection des menaces
PhishingSignatures true
PhishingScanURLs true
PhishingAlwaysBlockSSLMismatch false
PhishingAlwaysBlockCloak false

# Base de données
DatabaseDirectory /var/lib/clamav
# Les mises à jour sont gérées par freshclam dans le conteneur
